<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>


    <button index='0'>点击</button>
    <button index='1'>点击</button>
    <button index='2'>点击</button>

    <script>
        // alert(Boolean([]&&0));
        // console.log(((typeof [...[1, 2, 3]])));
        // console.log([...[1, 2, 3]]);


        /* let reg = /\{\{(.+?)\}\}/g;

        let str = '{{jin}}--{{shuo}}';

        str = str.replace(reg, (_, g) => {
            return '666';
        })

        console.log(str); */

        /* if(1){
            console.log('jinshuo');
        } */


        /* function a() {
            return function () {
                console.log(1);
            }
        }
        debugger
        let fn = a();
        fn();
        a = null;
        fn(); */


        /* function a() {
            return 1;
        }
        debugger
        let res = a();
        console.log(res);
        console.log(res); */



        /* function a() {
            var x = 1;
            return function () {
                console.log(x);
            }
        }
        debugger
        let fn = a();
        fn();
        a = null;
        fn(); */


        /* var a = 0;
        if (true) {
            a = 1;
            function a() { };
            a = 2;
            console.log(a);  //2
        }
        console.log(a);  //1 */

        /* var a = 0;
        if (true) {
            a = 1;
            var a;
            a = 2;
            console.log(a);  //2
        }
        console.log(a);  //2 */

        /* var a = 0;
        if (true) {
            a = 1;
            let a;
            a = 2;
            console.log(a);
        }
        console.log(a); */
        //Uncaught ReferenceError: Cannot access 'a' before initialization

        /* var a = 0;
        if (true) {
            a = 1;
            var a = 0;
            a = 2;
            console.log(a);  //2
        }
        console.log(a);  //2 */

        /* var f = 1;
        if (1) {
            function f() {
                console.log(1);
            }
        }
        console.log(f); */

        /* function A(){
            var x=1;
            console.log(x);
            return function(){
                console.log(1);
            }
        }
        var f=A(); */

        /* var arr[...];
        for (var i = 0; i < 5; i++) {
            (function (i) {
                buttonList[i].onclick = function () {
                    document.body.style.backgroundColor = arr[i];
                }
            })(i);
        }

        for (var i = 0; i < 5; i++) {
            buttonList[i].onclick = (function (i) {
                return function () {
                    document.body.style.backgroundColor = arr[i];
                }
            })(i);
        } */


        // debugger
        /* var buttonList = document.getElementsByTagName('button');
        var arr = ['red', 'blue', 'black'];
        for (var i = 0; i < buttonList.length; i++) {
            (function (i) {
                buttonList[i].onclick = function (i) {
                    console.log(i);
                    document.body.style.backgroundColor = arr[i];
                }
            })(i)
        } */

        /* var buttonList = document.getElementsByTagName('button');
        var arr = ['red', 'blue', 'black'];
        for (var i = 0; i < buttonList.length; i++) {
            (function (i) {
                buttonList[i].onclick = function () {
                    console.log(i);
                    document.body.style.backgroundColor = arr[i];
                }
            })(i)
        } */

        /* var buttonList = document.getElementsByTagName('button');
        var arr = ['red', 'blue', 'black'];
        for (var i = 0; i < buttonList.length; i++) {
            buttonList[i].index = i;
            buttonList[i].onclick = function () {
                var color = arr[this.index];
                document.body.style.backgroundColor = color;
            }
        } */

        /* var arr = ['red', 'blue', 'black'];
        document.body.onclick = function (e) {
            let target = e.target;
            targetTag = target.tagName;
            if (targetTag === 'BUTTON') {
                var index = target.getAttribute('index');
                document.body.style.backgroundColor = arr[index];
            }
        } */


        /* var module1 = (function () {
            var find = function () {
                console.log(1);
            }
            // debugger
            module2.update();
            return {
                find
            }
        })()

        var module2 = (function () {
            var update = function () {
                console.log(2);
            }
            return {
                update
            }
        })() */


        /* if(0){
            var f=function(){
                console.log(1);
            }
        }
        console.log(f); */

        /* function getCss(element, attr) {
            if ('getComputedStyle' in window) {
                getCss = function (element, attr) {
                    return window.getComputedStyle(element)[attr];
                }
            } else {
                getCss = function (element, attr) {
                    return element.currentStyle[attr];
                }
            }
            return getCss(element, attr);
        }


        function compose(...funcs) {
            return function (...args) {
                if (funcs.length === 0) {
                    return args;
                }
                if (funcs.length === 1) {
                    return funcs[0](...args);
                }
                return funcs.reduce((n, func) => {
                    return Array.isArray(n) ? func(...n) : func(n);
                }, args)
            }
        } */


        /* console.log(a);
        a = 12; */

        /* var a = 1;
        var b = 2;
        console.log('hhh', a + b);

        console.log('hhh'+1+2); */

        // console.log(f);
        /* (function f() {
            console.log(1);
        })(); */

        /*  console.log(f);
         function f(){
             console.log(1);
         }
  */


        /* function f(x) {
            console.log(x);
            var x = 20;
            console.log(x);
            function x() {
                console.log(1);
            }
            console.log(x);
        }
        f(10); */

        /* {
            console.log(foo);
            function foo() { };
            foo = 1;
            console.log(foo);
        }
        console.log(foo);
 */

        /* {
            console.log(foo);
            console.log(window.foo);
            function foo() {
                console.log(1);
            }
            console.log(window.foo);
            foo = 1;
            function foo() {
                console.log(2);
            }
            console.log(foo);
        }
        console.log(foo); */


        /* var a = 12;
        if (true) {
            console.log(a);
            a = 13;
            console.log(a);
            function a() { };
            a = 14;
            console.log(a);
        }
        console.log(a); */

        /* debugger
        var x = 1;
        function f(x, y = function () { x = 2 }) {
            var x;
            y();
            console.log(x);
        }
        f(5);
        console.log(x); */


        // debugger
        /* var x = 1;
        function f(x, y = 2) {
            x = 10;
            console.log(x);
        }
        f(5);
        console.log(x); */

        /* debugger
        var x = 1;
        function f(x, y = function () { x = 2 }) {
            function x() {
                console.log(1);
            }
            y();
            console.log(x);
        }
        f(5);
        console.log(x); */


        /* var z = 2;
        function f(x, y, z) {
            z = 3;
            console.log(arguments[2]);
        }
        z = f(1, 2);
        console.log(z); */

        /* (function f() {
            console.log(f);  // undefined
            var f = 1;
            console.log(f);  // 1
        })(); */

        /* (function f() {
            function f(){
                console.log(1);
            };
            console.log(f);  // 1
        })(); */

        /* function f() {
            f = 1;
            console.log(f);
        }
        f(); */


        /* var b = 10;
        (function b() {
            b = 20;
            console.log(b);  // f b(){...}
        })()
        console.log(b);  // 10 */



    </script>

    <script>

        /* function a() {
            console.log(1);
        }
        let a = 2; */


        /* var a = 1;
        var b = 2;
        if (1) {
            var a = 3;
            let b = 4;
            console.log(a, b);
        }
        console.log(a, b); */


        /* for(let i=0; i<6; i++){
            console.log(1);
        }
        console.log(i); */


        // alert(typeof Array);

        /* function f(x, y, z){
            x=1;
            y=2;
        }
        console.log(f.length);  // 3
        console.log(f.name);  // f
        console.log(f.prototype.constructor);  // f f(x, y, z){x=1; y=2;} */

        /* Object.create = function (prototype) {
            function Temp() { };
            Temp.prototype = prototype;
            return new Temp();
        } */


        // console.log(typeof undefined);


        /* function Fn() {

        }
        Fn.prototype.sayName = function () {
            console.log('name: lmy');
        }
        Fn.prototype.sayHello = function () {
            console.log('Hello');
        } */
        /* let newPrototype = Object.create(Fn.prototype);
        Object.assign(newPrototype, {
            sayName() {
                console.log('name: LiMengYing');
            },
            sayAge() {
                console.log('age: 30');
            }
        }) */
        /* let newPrototype = {
            sayName() {
                console.log('name: LiMengYing');
            },
            sayAge() {
                console.log('age: 30');
            }
        }
        newPrototype.__proto__ = Fn.prototype;
        Fn.prototype = newPrototype;
        let obj = new Fn();
        obj.sayName();
        obj.__proto__.__proto__.sayName();
        obj.sayHello(); */

        /* let obj = { a: 1 };
        obj.__proto__.b = 2;
        for(let key in obj){
            console.log(key);
        } */

        /* let fn = function () {
            this.a = 1;
            let b = 2;
            c: 3
        }
        fn();
        console.log(fn.hasOwnProperty('a'));  // false
        console.log(fn.hasOwnProperty('b'));  // false
        console.log(fn.hasOwnProperty('c'));
        console.log(fn.c);
        console.log(fn.b); */


        /* function Foo(){
            getName=function(){
                console.log(1);
            }
            return this;
        }
        Foo.getName=function(){
            console.log(2);
        }
        Foo.prototype.getName=function(){
            console.log(3);
        }
        var getName=function(){
            console.log(4);
        }
        function getName(){
            console.log(5);
        }

        Foo.getName();  // 2
        getName();  // 4
        Foo().getName();  // 1
        getName();  // 1
        new Foo.getName();  // 2
        new Foo().getName();  // 3
        new new Foo().getName();  // 3 */


        // call继承
        /* function Parent() {
            this.x = 100;
        }
        Parent.prototype.getX = function () {
            return this.x;
        }
        function Child() {
            Parent.call(this);
            this.y = 200;
        }
        Child.prototype.getY = function () {
            return this.y;
        } */


        /* class Parent {
            constructor() {
                this.x = 100;
            }
            getX() {
                return this.x;
            }
        }
        class Child extends Parent {
            constructor() {
                super();
                this.y = 200;
            }
            getY() {
                return this.y;
            }
        } */


        /* function Fn() {
            this.x = 100;
            var x = 200;
            console.log(x);
        } */
        // Fn();
        // console.log(x);

        /* var obj = {};
        Fn.call(obj);
        console.log(obj); */

        // alert(null == undefined == 0 == '' == false);
        // alert(null==0)
        // alert(undefined==0)
        // alert(null == undefined);  // true
        // alert(0=='')  // true
        // alert(0 == false);  // true
        // alert(1==true);  // true

        /* Fn.call();
        console.log(window.x); */


        /* function Fn() {
            return 1;
        }
        let res = Fn.call();
        console.log(res);  // 1 */


        /* // call源码
        Function.prototype.call = function (context, ...params) {
            context == undefined ? context = window : null;
            let contextType = typeof context;
            if (!/^(object|function)$/.test(contextType)) {
                if (/^(symbol|bigint)$/.test(contextType)) {
                    context = Object(context);
                }
                else {
                    context = new contextType.constructor(context);
                }
            }
            let key = Symbol('key'),
                result;
            context[key] = this;
            result = context[key](...params);
            delete context[key];
            return result;
        }
        function Fn(x, y) {
            this.x = x;
            this.y = y;
        }
        let obj = {};
        Fn.call(obj, 1, 2);
        console.log(obj); */


        /* function slice() {
            let arr = [];
            for (let i = 0; i < this.length; i++) {
                arr.push(this[i]);
            }
            return arr;
        } */

        // let utils = (function () {
        //     // 方案一
        //     /* function toArray(...args) {
        //         return args;
        //     } */
        //     // 方案二
        //     /* function toArray() {
        //         return [...arguments];
        //     } */
        //     // 方案三
        //     function toArray() {
        //         return [].slice.call(arguments);
        //     }
        //     return {
        //         toArray
        //     }
        // })()
        // let arr = utils.toArray(1, 2, 3);
        // console.log(arr);


        /* function fn(){
            [].forEach.call(arguments, item=>{
                console.log(item);
            })
        }
        fn(1, 2, 3); */


        // 深克隆
        /* function deepClone(obj) {
            const constructor = obj.constructor;
            if (obj === null) return null;
            if (typeof obj !== 'object') return obj;
            if (/^(RegExp | Date)$/i.test(constructor.name)) return new constructor(obj);
            let newObj = new constructor();
            for (let key in obj) {
                if (!obj.hasOwnProperty(key)) break;
                newObj[key] = deepClone(obj[key]);
            }
            return newObj;
        } */


        // 数据类型检测
        /* function toType(obj) {
            let type = Object.prototype.toString.call(obj);
            return /^\[object ([a-z]+)\]$/i.exec(type)[1].toLowerCase();
        } */

        // jQuery的解决方案
        /* var typeArr = ['Boolean', 'Number', 'String', 'Function', 'Array',
            'Date', 'RegExp', 'Object', 'Error', 'Symbol'];
        var class2Type = {};
        typeArr.forEach(item => {
            class2Type['[object ' + item + ']'] = item.toLowerCase();
        })
        function toType(obj) {
            if (obj == null) return obj + '';
            return typeof obj === 'object' || typeof obj === 'function' ?
                class2Type[Object.prototype.toString.call(obj)] || 'object' :
                typeof obj;
        }


        // 检测是否为类数组
        function isArrayLike(obj) {
            var length = !!obj && "length" in obj && obj.length,
                type = toType(obj);

            if (isFunction(obj) || isWindow(obj)) {
                return false;
            }

            return type === "array" || length === 0 ||
                typeof length === "number" && length > 0 && (length - 1) in obj;
        }


        // 检测是否为空对象
        function isEmptyObject(obj) {
            if (!obj || toType(obj) !== 'object')
                return false;
            for (var key in obj) {
                if (obj.hasOwnProperty(key))
                    return false;
            }
            return true;
        } */



        /* let obj1 = {
            x: function () {
                console.log(1);
                console.log(2);
            },
            y: function () {
                console.log(1);
            }
        }

        let obj2 = {
            x: function () {
                console.log(2);
                console.log(1);
            },
            y: function () {
                console.log(1);
            }

        }
        console.log(obj1.x.toString()===obj2.x.toString());  //false

 */



        /* function isEaqual(val1, val2) {
            const type1 = val1 === null ? 'null' : typeof val1;
            const type2 = val2 === null ? 'null' : typeof val2;
            if (type1 === 'function' && type2 === 'function') {
                return val1.toString() === val2.toString();
            }
            if (type1 === 'object' && type2 === 'object') {
                const ct1 = val1.constructor;
                const ct2 = val2.constructor;
                if (ct1 === RegExp && ct2 === RegExp) {
                    return ct1.toString() === ct2.toString();
                }
                if (ct1 === Date && ct2 === Date) {
                    return val1.toString() === val2.toString();
                }
                const keys1 = Object.keys(val1);
                const keys2 = Object.keys(val2);
                if (keys1.length !== keys2.length) return false;
                for (let i = 0; i < keys1.length; i++) {
                    let key1 = keys1[i];
                    let key2 = keys2[i];
                    if (key1 !== key2) return false;
                    let flag = isEaqual(val1[key1], val2[key2]);
                    if (!flag) return false;
                }
                return true;
            }
            return val1 === val2;
        } */



        /*         // instanceof源码
                function instanceOf(example, Fun) {
                    let _proto = Object.getPrototypeOf(example);
                    let _prototype = Fun.prototype;
                    while (true) {
                        if (!_proto) return false;
                        if (_proto === _prototype) return true;
                        _proto = Object.getPrototypeOf(_proto);
                    }
                }
                // 在浏览器内部调用instanceof时是基于Function.prototype的Symbol.hasinstance实现的
                Function.prototype[Symbol.hasInstance].call(Array, []);  //true
                Array[Symbol.hasInstance]([]);  //true
         */



        /* function initParams(num) {
            num = Number(num);
            return isNaN(num) ? 0 : num;
        }

        Number.prototype.plus = function (num) {
            num = initParams(num);
            return this + num;
        }
        Number.prototype.minus = function (num) {
            num = initParams(num);
            return this - num;
        }

        let n = 1;
        console.log(n.plus(2).minus(1));
        console.log(n.plus('a'));
        console.log(n.plus('b').minus(2)); */


        /* Number.prototype.plus = function (num) {
            console.log(this);
            console.log(typeof this);
            return this + num;
        }
        let n = 1;
        console.log(n.plus(2));
        console.log(Number(1).plus(2));
        // console.log(1.plus(2));
        console.log('1'.plus(2)); */



        // 实现queryURLParams
        // url.queryURLParams('from') => xxx
        // url.queryURLParams('_HASH') => yyy
        // 方法一：通过 new URL()
        /* String.prototype.queryURLParams = function (key) {
            let obj = {};
            let {
                search,
                hash
            } = new URL(this);
            if (hash) {
                obj['_HASH'] = hash.substring(1);
            }
            if (search) {
                search = search.substring(1).split('&');
                search.forEach(item => {
                    let [key, val] = item.split('=');
                    obj[key] = val;
                })
            }
            return !key ? '' : obj[key];
        }
        let url = "http://www.baidu.com?name=js&age=26#alipay";
        console.log(url.queryURLParams('_HASH'));
        console.log(url.queryURLParams('name'));
        console.log(url.queryURLParams('age')); */

        // 方法二：正则表达式
        /* String.prototype.queryURLParams = function (key) {
            let obj = {};
            this.replace(/([^?=&#]+)=([^?=&#]+)/g, (_, key, val) => {
                obj[key] = val;
            });
            this.replace(/#([^?=&#]+)/g, (_, hash) => {
                obj['_HASH'] = hash;
            });
            return !key ? '' : obj[key];
        }
        let url = "http://www.baidu.com?name=js&age=26#alipay";
        console.log(url.queryURLParams('_HASH'));
        console.log(url.queryURLParams('name'));
        console.log(url.queryURLParams('age')); */



        /* class A {
            constructor(x, y) {
                this.x = x;
                this.y = y;
            }
            z = 1  //给实例设置的私有属性
            static n = 2;  //类静态属性
            static setX(n) {  //类静态方法
                this.n = n;
            }
        }
        let a = new A(1, 2);
        console.log(a.__proto__.z);  //undefined
        console.log(A.z);  //undefined
        console.log(a.z);  //1
        A.prototype._z = 3;  //类的原型上的属性只能在外部设置
        console.log(a._z);  //3
        console.log(a.__proto__._z);  //3
        A.setX(10);
        console.log(A.n);  //10 */



        /* let obj = {
            2: 3,
            3: 4,
            length: 2,
            push: Array.prototype.push
        }
        obj.push(1);
        obj.push(2);
        console.log(obj);  //{2:1, 3:2, length:4, push:f} */


        // a为何值时以下 if 语句的条件为真？
        // 注：==比较的时候，如果两边数据类型不一致，默认会进行数据类型转换
        // 方案一：
        // 对象转换为数字，会调取valueOf（获取原始值）/toString(如果对象私有属性中有toString，
        // 则不会再向原型上去查找)
        /* var a = {
            i: 0,
            toString() {
                return ++this.i;
            }
        } */
        // 方案二：
        /* var a = [1, 2, 3];
        a.toString = a.shift;
        if (a == 1 && a == 2 && a == 3) {
            console.log('ok');    //ok
        } */
        /* // 方案三：数据劫持
        var i = 0;
        Object.defineProperty(window, 'a', {
            get() {
                return ++i;
            }
        })
        if (a == 1 && a == 2 && a == 3) {
            console.log('ok');    //ok
        } */



        /* // 实现 toArray方法
        // 方案一：
        function toArray(...args) {
            return args;
        }
        // 方案二：
        function toArray() {
            return [...arguments]
        }
        // 方案三：
        function toArray() {
            return Array.from(arguments);
        }
        // 方案四：
        function toArray() {
            var arr = [];
            for (var i = 0; i < arguments.length; i++) {
                arr.push(arguments[i]);
            }
            return arr;
        }
        // 方案五：
        // slice方法源码模拟
        Array.prototype.slice = function () {
            var arr = [];
            for (let i = 0; i < this.length; i++) {
                arr.push(this[i]);
            }
            return arr;
        }
        function toArray() {
            return Array.prototype.slice.call(arguments);
        }
        // 方案六：
        function toArray() {
            var arr = [];
            [].forEach.call(arguments, item => {
                arr.push(item);
            })
            return arr;
        } */


        // 内置call方法的实现原理
        // 'use strict'
        /*         Function.prototype.call = function (obj, ...args) {
                    obj = obj == undefined ? window : obj;
                    let objType = typeof obj;
                    if (!/^(object|function)$/i.test(objType)) {
                        obj = Object(obj);
                    }
                    let key = Symbol('key');
                    obj[key] = this;
                    let res = obj[key](...args);
                    delete obj[key];
                    return res;
                }
                function fn(x, y) {
                    this.x = x;
                    this.y = y;
                    return this.x + this.y;
                }
                let obj = {
                    x: 1,
                    y: 2
                }
                let res = fn.call(obj, 3, 4);
                console.log(obj);
                console.log(res); */

        /* function fn(...args) {
            console.log(...args);  //1 2 3
            console.log(args);  //[1, 2, 3]
        }
        fn(1, 2, 3);
 */



        /* function fn(...params) {
            console.log(...params);
        }
        let obj = {};
        fn.apply(obj, [1, 2, 3]);  //1 2 3

        function fn(...params) {
            console.log(params);
        }
        let obj = {};
        fn.apply(obj, [1, 2, 3]);  //[1, 2, 3] */



        /* var name = 'js';
        function A(x, y) {
            var res = x + y;
            console.log(res, this.name);
        }
        function B(x, y) {
            var res = x - y;
            console.log(res, this.name);
        }
        B.call(A, 40, 30);
        B.call.call.call(A, 20, 10);
        Function.prototype.call(A, 60, 50);
        Function.prototype.call.call.call(A, 80, 70); */



        /* // bind源码
        Function.prototype.bind = function (context, ...params) {
            let _this = this;
            //返回的内层函数也可能需要接收参数，例如：事件绑定函数需要接收事件e
            // =>
            // document.body.onclick=function(e){
            //     fn.call(obj, 1, 2, e);
            // }
            // =>
            // document.body.onclick = fn.bind(obj, 1, 2);
            // =>
            // 所以，返回的函数需要加上 ...args
            // =>
            return function (...args) {
                _this.call(context, ...params.concat(args));
            }
        }

        let obj = {};
        function fn(x, y) {
            this.x = x;
            this.y = y;
        }
        let f = fn.bind(obj, 1, 2);
        f();
        console.log(obj);  //{x: 1, y: 2} */



        // 函数的防抖
        /* function debounce(func, wait = 500, immediate = false) {
            let timer,
                now;
            return function (...args) {
                clearTimeout(timer);
                now = immediate && !timer;
                now ? func.call(this, ...args) : null;
                timer = setTimeout(_ => {
                    timer = null;
                    !immediate ? func.call(this, ...args) : null;
                }, wait);
            }
        }
        function func(ev) {
            console.log(ev);
            console.log('ok');
        }
        let btn = document.getElementsByTagName('button')[0];
        // btn.onclick = debounce(func);
        btn.onclick = debounce(func, 500, true); */


        // 函数的节流
        function throttle(func, delay = 1000) {
            // let timer = null;
            let previous = 0;
            return function (...params) {
                let now = new Date(),
                    remainingTime = delay - (now - previous);
                if (remainingTime <= 0) {
                    // clearTimeout(timer);
                    // timer = null;
                    previous = now;
                    func.call(this, ...params);
                }
                /* else if (!timer) {
                    timer = setTimeout(_ => {
                        clearTimeout(timer);
                        timer = null;
                        previous = new Date();
                        func.call(this, ...params);
                    }, remainingTime);
                } */
            };
        }
        function func(ev) {
            console.log(ev);
            console.log('ok');
        }
        let btn = document.getElementsByTagName('button')[0];
        btn.onclick = throttle(func);



    </script>

</body>

</html>